{% extends 'base.html' %}
{% load mathfilters %}
{% block title %}
    <title>Yash Team Works| Project Documents Upload</title>
{% endblock %}
{% block content %}
    <div class="card m-5">
        <div class="card-header"><strong>{{project_obj.name}} - {{project_document_form.instance.name}} - Document Details</strong></div>
        <div class="card-body">
            <div class="row">
                {% for field in project_document_form %}
                    {% if field.name == 'description' or field.name == 'keywords' %}
                        <div class="col-12">
                            <div class="form-group">
                                <label for="{{ field.id_for_label }}">{{field.label}}</label><br>
                                {{ field.value|safe }}
                            </div>
                        </div>
                    {% elif field.name == 'document' %}
                        <div class="col-6">
                            <div class="form-group">
                                <label for="{{ field.id_for_label }}">{{field.label}}</label>
                                <div>
                                    <i class="fas fa-file"></i> {{project_document_form.instance.file_name}} 
                                    {% if project_document_form.instance.file_size <= 1000000 %}
                                        ({{project_document_form.instance.file_size|div:"1024"|floatformat:"2" }} KB )<br>
                                    {% else %}
                                        ({{project_document_form.instance.file_size|div:"1048576"|floatformat:"2" }} MB )<br>
                                    {% endif %}
                                    <a href='{{project_document_form.instance.file_url}}' target="_blank">
                                        <i class="fa fa-download"></i>&nbsp;Download
                                    </a>&nbsp;
                                    <a href='http://docs.google.com/gview?url={{project_document_form.instance.file_url}}&embedded=true' target="_blank">
                                        <i class="fas fa-eye"></i>&nbsp;View
                                    </a>
                                </div>
                            </div>
                        </div>
                    {% else %}
                        <div class="col-6">
                            <div class="form-group">
                                <label for="{{ field.id_for_label }}">{{field.label}}</label><br>
                                {{ field }}
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
    <script>
        $(document).on('change', '#id_document', function(){
            if(this.files[0].size > 30000000) {
                alert("Please upload file less than 10MB. Thanks!!");
                $(this).val('');
                return false
              }
             let ftype = this.files[0].type
             let fname = this.files[0].name
             let fextension = fname.substring(fname.lastIndexOf('.')+1)
             let file_type = $(this).attr('file-type')
             let validExtensions = ["pdf", "doc", "docx", "txt", "ppt", "pptx"];
             if ($.inArray(fextension, validExtensions) == -1){
                 alert("This type of files are not allowed!");
                 $(this).val('');
                 return false;
             }
        })
    </script>
    <style>
        label{
            font-weight: bold;
        }
        input, select{
            pointer-events:none;
        }
    </style>
{% endblock %}